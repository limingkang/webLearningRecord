<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js相等运算符==规则 | 前端学习</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="努力学习">
    <link rel="preload" href="/webLearningRecord/assets/css/0.styles.32aa171d.css" as="style"><link rel="preload" href="/webLearningRecord/assets/js/app.bdc4d5ac.js" as="script"><link rel="preload" href="/webLearningRecord/assets/js/2.1a231426.js" as="script"><link rel="preload" href="/webLearningRecord/assets/js/19.ec38cef5.js" as="script"><link rel="prefetch" href="/webLearningRecord/assets/js/10.6c45162c.js"><link rel="prefetch" href="/webLearningRecord/assets/js/11.f477fe3a.js"><link rel="prefetch" href="/webLearningRecord/assets/js/12.719839a4.js"><link rel="prefetch" href="/webLearningRecord/assets/js/13.2e776131.js"><link rel="prefetch" href="/webLearningRecord/assets/js/14.6961d267.js"><link rel="prefetch" href="/webLearningRecord/assets/js/15.94790cc9.js"><link rel="prefetch" href="/webLearningRecord/assets/js/16.5c5eee38.js"><link rel="prefetch" href="/webLearningRecord/assets/js/17.025ef091.js"><link rel="prefetch" href="/webLearningRecord/assets/js/18.ef4a8780.js"><link rel="prefetch" href="/webLearningRecord/assets/js/20.f6711983.js"><link rel="prefetch" href="/webLearningRecord/assets/js/21.0cef24fe.js"><link rel="prefetch" href="/webLearningRecord/assets/js/22.9224a013.js"><link rel="prefetch" href="/webLearningRecord/assets/js/23.ec789df6.js"><link rel="prefetch" href="/webLearningRecord/assets/js/24.3bce65fe.js"><link rel="prefetch" href="/webLearningRecord/assets/js/25.f4d74d85.js"><link rel="prefetch" href="/webLearningRecord/assets/js/26.70ee71fc.js"><link rel="prefetch" href="/webLearningRecord/assets/js/27.39bdc05b.js"><link rel="prefetch" href="/webLearningRecord/assets/js/28.31277bb6.js"><link rel="prefetch" href="/webLearningRecord/assets/js/29.97b7aecc.js"><link rel="prefetch" href="/webLearningRecord/assets/js/3.9f1b9f7a.js"><link rel="prefetch" href="/webLearningRecord/assets/js/30.bcf3c482.js"><link rel="prefetch" href="/webLearningRecord/assets/js/31.e07b317a.js"><link rel="prefetch" href="/webLearningRecord/assets/js/32.1352871c.js"><link rel="prefetch" href="/webLearningRecord/assets/js/33.f98a7f1c.js"><link rel="prefetch" href="/webLearningRecord/assets/js/34.3797f037.js"><link rel="prefetch" href="/webLearningRecord/assets/js/4.217c5e32.js"><link rel="prefetch" href="/webLearningRecord/assets/js/5.bd81a106.js"><link rel="prefetch" href="/webLearningRecord/assets/js/6.d3f0121d.js"><link rel="prefetch" href="/webLearningRecord/assets/js/7.c3e5ebfe.js"><link rel="prefetch" href="/webLearningRecord/assets/js/8.62631f20.js"><link rel="prefetch" href="/webLearningRecord/assets/js/9.094f8da5.js">
    <link rel="stylesheet" href="/webLearningRecord/assets/css/0.styles.32aa171d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/webLearningRecord/" class="home-link router-link-active"><!----> <span class="site-name">前端学习</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/limingkang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/limingkang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/webLearningRecord/" class="sidebar-heading clickable router-link-active"><span>浏览器工作原理和实践</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/webLearningRecord/browser-theory/chromeConstruct.html" class="sidebar-link">chrome架构</a></li><li><a href="/webLearningRecord/browser-theory/other.html" class="sidebar-link">缓存和安全</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/webLearningRecord/" class="sidebar-heading clickable router-link-active"><span>微前端架构</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/webLearningRecord/web-consttruct/singleSpa.html" class="sidebar-link">single-spa方式实现</a></li><li><a href="/webLearningRecord/web-consttruct/mySingleSpa.html" class="sidebar-link">自己实现一个微前端</a></li><li><a href="/webLearningRecord/web-consttruct/mircoapp.html" class="sidebar-link">microapp</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/webLearningRecord/" class="sidebar-heading clickable router-link-active"><span>前端性能监控</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/webLearningRecord/web-observe/web-observe.html" class="sidebar-link">构建前端性能监控</a></li><li><a href="/webLearningRecord/web-observe/user-behavior.html" class="sidebar-link">用户行为录制</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/webLearningRecord/" class="sidebar-heading clickable router-link-active"><span>vue2源码分析</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/webLearningRecord/vue-analyze/vue2.html" class="sidebar-link">初始化过程</a></li><li><a href="/webLearningRecord/vue-analyze/components.html" class="sidebar-link">组件化</a></li><li><a href="/webLearningRecord/vue-analyze/reactive.html" class="sidebar-link">响应式原理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/webLearningRecord/" class="sidebar-heading clickable router-link-active"><span>包管理</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/webLearningRecord/bundle/analysize.html" class="sidebar-link">rollup</a></li><li><a href="/webLearningRecord/bundle/pnpm.html" class="sidebar-link">pnpm</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/webLearningRecord/" class="sidebar-heading clickable router-link-active"><span>vite</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/webLearningRecord/vite/prelearn.html" class="sidebar-link">基础知识</a></li><li><a href="/webLearningRecord/vite/analysize.html" class="sidebar-link">源码分析</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/webLearningRecord/" class="sidebar-heading clickable router-link-active"><span>react浅析</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/webLearningRecord/react/react.html" class="sidebar-link">react初探</a></li><li><a href="/webLearningRecord/react/two.html" class="sidebar-link">react架构实现</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/webLearningRecord/" class="sidebar-heading clickable router-link-active open"><span>经常忘记</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/webLearningRecord/forget/one.html" class="active sidebar-link">JavaScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webLearningRecord/forget/one.html#js相等运算符-规则" class="sidebar-link">js相等运算符==规则</a></li><li class="sidebar-sub-header"><a href="/webLearningRecord/forget/one.html#正则表达式功能" class="sidebar-link">正则表达式功能</a></li><li class="sidebar-sub-header"><a href="/webLearningRecord/forget/one.html#类型判断tostring、instanceof、typeof" class="sidebar-link">类型判断toString、instanceof、typeof</a></li><li class="sidebar-sub-header"><a href="/webLearningRecord/forget/one.html#js和css加载阻塞" class="sidebar-link">js和css加载阻塞</a></li><li class="sidebar-sub-header"><a href="/webLearningRecord/forget/one.html#es6-module循环引入" class="sidebar-link">es6 module循环引入</a></li><li class="sidebar-sub-header"><a href="/webLearningRecord/forget/one.html#杂物" class="sidebar-link">杂物</a></li></ul></li><li><a href="/webLearningRecord/forget/two.html" class="sidebar-link">TypeScript</a></li><li><a href="/webLearningRecord/forget/three.html" class="sidebar-link">CSS</a></li><li><a href="/webLearningRecord/forget/four.html" class="sidebar-link">Node</a></li><li><a href="/webLearningRecord/forget/five.html" class="sidebar-link">经常使用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/webLearningRecord/" class="sidebar-heading clickable router-link-active"><span>笔试题</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/webLearningRecord/algorithm/one.html" class="sidebar-link">算法</a></li><li><a href="/webLearningRecord/algorithm/two.html" class="sidebar-link">手写函数</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/webLearningRecord/" class="sidebar-heading clickable router-link-active"><span>随笔</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/webLearningRecord/think/mess.html" class="sidebar-link">杂谈</a></li><li><a href="/webLearningRecord/think/css.html" class="sidebar-link">css方法论</a></li><li><a href="/webLearningRecord/think/svelte.html" class="sidebar-link">svelte</a></li><li><a href="/webLearningRecord/think/frame.html" class="sidebar-link">框架</a></li><li><a href="/webLearningRecord/think/outer.html" class="sidebar-link">基础文章</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="js相等运算符-规则"><a href="#js相等运算符-规则" class="header-anchor">#</a> js相等运算符==规则</h2> <p><code>x == y</code></p> <ul><li>如果x或者y不是正常值（比如抛出一个错误），中断执行</li> <li>如果Type(x)与Type(y)相同，执行严格相等运算x === y</li> <li>undefined == null，返回true</li> <li>如果是数字和字符串比较，则将字符串转换为数字之后进行比较(空字符串和&quot;0&quot;转化为数字时候都是0)</li> <li>如果x和y其中有一个是布尔值，则把布尔值转换为数字，之后比较x == ToNumber(y)的结果</li> <li>如果只有其中一个是对象，那就将对象转换为原始值之后进行比较x == ToPrimitive(y)</li></ul> <p>原始值转化规则为调用toString方法对于数组[],[0]都是变为&quot;0&quot;而[1,2,3]变为&quot;1,2,3&quot;，如果是对象则会转换为&quot;[object Object]&quot;</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token boolean">false</span><span class="token operator">==</span><span class="token punctuation">[</span><span class="token punctuation">]</span>   <span class="token comment">//true</span>
<span class="token boolean">true</span><span class="token operator">==</span><span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span>   <span class="token comment">//true</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//弹出 'Number'</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">NaN</span> <span class="token operator">===</span> <span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//为 false</span>
</code></pre></div><p>可以出个简单的题目,下面代码中 a 在什么情况下会打印 1</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token operator">?</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 	conso<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>因为==会进行隐式类型转换会调用本类型toString或valueOf方法,重写他们即可</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  i<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token function">toString</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a<span class="token punctuation">.</span>i<span class="token operator">++</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  i<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token function">valueOf</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a<span class="token punctuation">.</span>i<span class="token operator">++</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
a<span class="token punctuation">.</span>join <span class="token operator">=</span> a<span class="token punctuation">.</span>shift<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> str1 <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token string">'11'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> str2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'11'</span><span class="token punctuation">)</span>
str1 <span class="token operator">==</span> str2 <span class="token comment">// true</span>
str1 <span class="token operator">===</span> str2 <span class="token comment">// false</span>
<span class="token keyword">typeof</span> str1  <span class="token comment">// &quot;string&quot;</span>
<span class="token keyword">typeof</span> str2 <span class="token comment">// &quot;object&quot;</span>
<span class="token comment">// ==时做了隐式转换，调用了toString</span>
<span class="token comment">// 2者类型不一样，一个是string，一个是object</span>
</code></pre></div><p>注意如果是转换为数字则优先使用valueOf，没有定义则使用toString方法，如果是转换为字符串则优先使用toString方法，没有定义
则使用valueOf方法</p> <h2 id="正则表达式功能"><a href="#正则表达式功能" class="header-anchor">#</a> 正则表达式功能</h2> <p>正常情况下就是贪婪模式，就是直接按最多次匹配,如果在量词后面加上?就表示非贪婪模式，对应匹配到最小个数的值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'12345678'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\d{3,6}/g</span><span class="token punctuation">,</span><span class="token string">'X'</span><span class="token punctuation">)</span>       <span class="token comment">//output: &quot;X78&quot;</span>
<span class="token string">'12345678'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\d{3,6}?/g</span><span class="token punctuation">,</span><span class="token string">'X'</span><span class="token punctuation">)</span>       <span class="token comment">//output: &quot;XX78&quot;</span>
<span class="token string">'123456789'</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/\d{3,5}?/g</span><span class="token punctuation">)</span>       <span class="token comment">//output: [&quot;123&quot;,&quot;456&quot;,&quot;789&quot;]</span>

<span class="token string">'a1b2c3d4'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/([a-z]\d){3}/g</span><span class="token punctuation">,</span><span class="token string">&quot;X&quot;</span><span class="token punctuation">)</span>   <span class="token comment">//output: &quot;Xd4&quot;</span>
<span class="token comment">// 量词最大作用是要给括号分组，这里没有括号的话就表示3个数字了</span>
</code></pre></div><p>正则中或|的使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'byroncasper'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/byron|casper/g</span><span class="token punctuation">,</span><span class="token string">&quot;X&quot;</span><span class="token punctuation">)</span>   <span class="token comment">//output:&quot;XX&quot;</span>
<span class="token string">'byronsperbyrcasper'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/byr(on|ca)sper/g</span><span class="token punctuation">,</span><span class="token string">&quot;X&quot;</span><span class="token punctuation">)</span>   <span class="token comment">//output:&quot;XX&quot;</span>
</code></pre></div><p>分组中的反向引用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//没有括号的时候就表示$1这样的直接的字符串，有括号的时候就是会被捕获就是值，但是我们也可以在分组后面加?:就可以不被捕获</span>
<span class="token string">'2015-12-25'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(\d{4})-(\d{2})-(\d{2})/g</span><span class="token punctuation">,</span><span class="token string">'$2/$3/$1'</span><span class="token punctuation">)</span>   <span class="token comment">//output:12/25/2015</span>
<span class="token string">'2015-12-25'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(?:\d{4})-(\d{2})-(\d{2})/g</span><span class="token punctuation">,</span><span class="token string">'$2/$3/$1'</span><span class="token punctuation">)</span>  <span class="token comment">// output:25/$3/12</span>
</code></pre></div><p>正向匹配?=和负向匹配?!</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'a2cc'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\w(?=\d)/g</span><span class="token punctuation">,</span><span class="token string">'X'</span><span class="token punctuation">)</span>     <span class="token comment">//output:'X2cc'</span>
<span class="token comment">// 满足是字母而且后面是一个数字的情况，注意括号里面的不参与匹配，只有在前一个符合情况下才看匹配的那个后面是否符合</span>

<span class="token operator">/</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">!</span>\d<span class="token operator">+</span>$<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">!</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span><span class="token constant">Z</span><span class="token punctuation">]</span><span class="token operator">+</span>$<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token operator">!</span>@#\$<span class="token operator">%</span>\<span class="token operator">^</span>\<span class="token operator">&amp;</span>\<span class="token operator">*</span><span class="token operator">+</span><span class="token operator">-</span><span class="token punctuation">]</span><span class="token operator">+</span>$<span class="token punctuation">)</span><span class="token punctuation">[</span>\w<span class="token operator">!</span>@#\$<span class="token operator">%</span>\<span class="token operator">^</span>\<span class="token operator">&amp;</span>\<span class="token operator">*</span><span class="token operator">+</span><span class="token operator">-</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">}</span>$<span class="token operator">/</span>g
<span class="token comment">//开头结尾不全是数字出现一次多次,不全是字母出现一次多次,不全是特殊字符出现多次,且以字母数字特殊字符开头结尾的6到18位</span>
</code></pre></div><p>lastIndex返回每次匹配的最后一个字符的下一位，以便下一次匹配（非全局模式下始终为0），最后没了的时候又重置为0.
所以为了使结果一样有时候这样写每一次都实例化一个正则，但是这耗内存(/\W/g).test('ab'),但是test只是为了检测用，所以
用这个方法的时候我们一般不用全局匹配</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> reg1<span class="token operator">=</span><span class="token regex">/\w/</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> reg2<span class="token operator">=</span><span class="token regex">/\w/g</span><span class="token punctuation">;</span>   <span class="token comment">//注意lastIndex是正则的属性</span>
reg1<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'ab'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//无论执行多少次都是true,因为lastIndex值始终为0</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg1<span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 0</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 0</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'ab'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'ab'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'ab'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 0</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'ab'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'ab'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'ab'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 0</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'ab'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg2<span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 1 2</span>
<span class="token punctuation">}</span>
</code></pre></div><p>exec的用法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> reg3<span class="token operator">=</span><span class="token regex">/\d(\w)(\w)\d/</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> reg4<span class="token operator">=</span><span class="token regex">/\d(\w)(\w)\d/g</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ts<span class="token operator">=</span><span class="token string">'$1ab2bb3cy4dd5ee'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ret<span class="token operator">=</span>reg3<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>ts<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//[&quot;1ab2&quot;, &quot;a&quot;, &quot;b&quot;, index: 1, input: &quot;$1ab2bb3cy4dd5ee&quot;]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ret<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ret<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// &quot;1ab2&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ret<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//&quot;1ab2,a,b&quot;    这是一个字符串</span>
<span class="token comment">// 其中ret是一个对象数组，第一个表示匹配到的值，后面是对应的分组匹配到的值，有几个分组，就有几个这个值，index值对应</span>
<span class="token comment">// 匹配到的字符串的开始位置，input对应你要查询的原字符串</span>

<span class="token keyword">while</span><span class="token punctuation">(</span>reg4<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>ts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg4<span class="token punctuation">.</span>lastIndex <span class="token operator">+</span> ret<span class="token punctuation">.</span>index <span class="token operator">+</span> ret<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//&quot;5 1 1ab2,a,b&quot;     &quot;11 7 3cy4,c,y&quot;     注意全局模式下贪婪匹配到最后一个</span>
</code></pre></div><p>search方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'a1b2c3d1'</span><span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>     <span class="token comment">//output:1</span>
<span class="token comment">// search方法用于查找返回匹配到的字符串的开始位置没找到就返回-1,这个方法忽略/g标志</span>
<span class="token comment">// 实际上对于字符串的像split,replace等方法最终都是隐式转换为正则表达式的</span>
<span class="token string">'a,b,c,d'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>会被转换为<span class="token string">'a,b,c,d'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex">/,/g</span><span class="token punctuation">)</span>输出<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span>
<span class="token string">'a1b2c3d4'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex">/\d/g</span><span class="token punctuation">)</span>以数字为分隔符输出数组<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span>
</code></pre></div><p>match方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> reg3<span class="token operator">=</span><span class="token regex">/\d(\w)\d/</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> reg4<span class="token operator">=</span><span class="token regex">/\d(\w)\d/g</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ts<span class="token operator">=</span><span class="token string">'$1a2b3c4d5e'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ret<span class="token operator">=</span>ts<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg3<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//[&quot;1a2&quot;, &quot;3c4&quot;,index: 1, input: &quot;$1a2b3c4d5e&quot;]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ret<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//  1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ret<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// &quot;1a2&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ret<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//&quot;1a2,3c4&quot;    这是一个字符串</span>
<span class="token comment">// match方法非全局模式下返回值和exec一样，没有匹配到的时候返回null</span>
<span class="token keyword">var</span> ret2<span class="token operator">=</span>ts<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg4<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ret2<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//[&quot;1a2&quot;, &quot;3c4&quot;]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ret2<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//  undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ret2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// &quot;1a2&quot;</span>
<span class="token comment">// 全局模式下只是返回匹配值的对象数组，没有就返回null，这个功能比exec弱一些，但是速度快一些</span>

<span class="token comment">// match代表匹配到的项，所以依次输出&quot;1b2&quot;  &quot;3d4&quot;,最终返回的字符串是&quot;a12c345e&quot;</span>
<span class="token comment">// group1,group2,group3代表匹配下的分组，没有分组的时候就没有几个分组值的参数</span>
<span class="token comment">// index代表匹配到的开始位置，origin代表原始字符串</span>
<span class="token string">'a1b2c3d45e'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(\d)(\w)(\d)/g</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">match<span class="token punctuation">,</span>group1<span class="token punctuation">,</span>group2<span class="token punctuation">,</span>group3<span class="token punctuation">,</span>index<span class="token punctuation">,</span>origin</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>match<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> group1<span class="token operator">+</span>group3<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>还有一些其他小注意点</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'a1b2c3d1'</span><span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span> <span class="token comment">//output:1</span>
<span class="token comment">//search方法用于查找返回匹配到的字符串的开始位置没找到就返回-1,这个方法忽略/g标志</span>
<span class="token comment">//实际上对于字符串的像split,replace等方法最终都是隐式转换为正则表达式的</span>
<span class="token string">'a,b,c,d'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span> <span class="token operator">===</span><span class="token operator">&gt;</span> <span class="token string">'a,b,c,d'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex">/,/g</span><span class="token punctuation">)</span>输出<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span>
<span class="token string">'a1b2c3d4'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex">/\d/g</span><span class="token punctuation">)</span> <span class="token operator">===</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span>

<span class="token comment">// 任意字符12345678 通过正则转换成 12,345,678</span>
n<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\B(?=(\d{3})+$)/g</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> RegExp <span class="token operator">=</span> <span class="token regex">/^(123)(456)\2\1$/</span><span class="token punctuation">;</span> <span class="token comment">// 匹配 123456456123</span>
<span class="token keyword">var</span> RegExp1 <span class="token operator">=</span> <span class="token regex">/^(123)(456)\1$/</span><span class="token punctuation">;</span> <span class="token comment">// 匹配 123456123</span>
<span class="token keyword">var</span> RegExp1 <span class="token operator">=</span> <span class="token regex">/^(123)(456)\2$/</span><span class="token punctuation">;</span> <span class="token comment">// 匹配 123456456</span>
</code></pre></div><p><a href="https://github.com/any86/any-rule" target="_blank" rel="noopener noreferrer">正则表达式库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="类型判断tostring、instanceof、typeof"><a href="#类型判断tostring、instanceof、typeof" class="header-anchor">#</a> 类型判断toString、instanceof、typeof</h2> <h4 id="tostring"><a href="#tostring" class="header-anchor">#</a> toString</h4> <p>每一个继承 Object 的对象都有toString方法，如果 toString 方法没有重写的话，会返回 [Object type]，其中 type 为
对象的类型。但当除了 Object 类型的对象外，其他类型直接使用 toString 方法时，会直接返回都是内容的字符串，所以我们需要
使用call或者apply方法来改变toString方法的执行上下文</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> an <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Hello'</span><span class="token punctuation">,</span><span class="token string">'An'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
an<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Hello,An&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>an<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[object Array]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'An'</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object String]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Number]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Symbol]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Null]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Undefined]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Function]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'An'</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Object]&quot;</span>
</code></pre></div><h4 id="typeof"><a href="#typeof" class="header-anchor">#</a> typeof</h4> <p>主要用于检测基本数据类型，返回值为6个字符串，分别为string、Boolean、number、function、object、undefined,但
是在判断null、array、object以及函数实例（new + 函数）时，得到的都是object。这使得在判断这些数据类型的时候，得不到真
是的数据类型。由此引出instanceof</p> <h4 id="instanceof"><a href="#instanceof" class="header-anchor">#</a> instanceof</h4> <p>instanceof 的内部机制是通过判断对象的原型链中是不是能找到类型的 prototype</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
obj <span class="token keyword">instanceof</span> <span class="token class-name">Bar</span> <span class="token comment">//true</span>
obj <span class="token keyword">instanceof</span> <span class="token class-name">Foo</span> <span class="token comment">//true</span>
<span class="token comment">// 注意当在比较的时候如果左操作数不是对象，则返回false</span>
<span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token string">'foo'</span> <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
<span class="token string">'foo'</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

<span class="token comment">// 实现方法(有漏洞)</span>
<span class="token keyword">function</span> <span class="token function">_instanceof</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">L</span><span class="token punctuation">,</span> <span class="token constant">R</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//L为instanceof左表达式，R为右表达式</span>
  <span class="token keyword">let</span> Ro <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>prototype <span class="token comment">//原型</span>
  <span class="token constant">L</span> <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>__proto__ <span class="token comment">//隐式原型</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">L</span> <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//当到达L原型链顶端还未匹配，返回false</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">L</span> <span class="token operator">===</span> Ro<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//全等时，返回true</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token constant">L</span> <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>__proto__
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="js和css加载阻塞"><a href="#js和css加载阻塞" class="header-anchor">#</a> js和css加载阻塞</h2> <p>首先我们来了解下资源的加载方式有哪些</p> <h3 id="prefetch、preload"><a href="#prefetch、preload" class="header-anchor">#</a> prefetch、preload</h3> <p>preload 顾名思义就是一种预加载的方式，它通过声明向浏览器声明一个需要提交加载的资源，当资源真正被使用的时候立即执行，就
无需等待网络的消耗,它可以通过 Link 标签进行创建：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用 link 标签静态标记需要预加载的资源</span>
<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;preload&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;/path/to/style.css&quot;</span> <span class="token keyword">as</span><span class="token operator">=</span><span class="token string">&quot;style&quot;</span><span class="token operator">&gt;</span>

<span class="token comment">// 或使用脚本动态创建一个 link 标签后插入到 head 头部</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">const</span> link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'link'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
link<span class="token punctuation">.</span>rel <span class="token operator">=</span> <span class="token string">'preload'</span><span class="token punctuation">;</span>
link<span class="token punctuation">.</span>as <span class="token operator">=</span> <span class="token string">'style'</span><span class="token punctuation">;</span>
link<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">'/path/to/style.css'</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>当浏览器解析到这行代码就会去加载 href 中对应的资源但不执行，待到真正使用到的时候再执行，另一种方式方式就是在 HTTP 响应头
中加上 preload 字段，兼容性看IE 和 Firefox 都是不支持的，兼容性覆盖面达到 73%</p> <p>prefetch 跟 preload 不同，它的作用是告诉浏览器未来可能会使用到的某个资源，浏览器就会在闲时去加载对应的资源，若能预测
到用户的行为，比如懒加载，点击到其它页面等则相当于提前预加载了需要的资源。它的用法跟 preload 是一样的，prefetch 比
preload 的兼容性更好，覆盖面可以达到将近 80%</p> <p>当一个资源被 preload 或者 prefetch 获取后，它将被放在内存缓存中等待被使用，如果资源位存在有效的缓存极致（如
cache-control 或 max-age），它将被存储在 HTTP 缓存中可以被不同页面所使用。正确使用 preload/prefetch 不会造
成二次下载，也就说：当页面上使用到这个资源时候 preload 资源还没下载完，这时候不会造成二次下载，会等待第一次下载并执
行脚本。对于 preload 来说，一旦页面关闭了，它就会立即停止 preload 获取资源，而对于 prefetch 资源，即使页面关
闭，prefetch 发起的请求仍会进行不会中断</p> <h3 id="acync、defer"><a href="#acync、defer" class="header-anchor">#</a> acync、defer</h3> <p>默认情况下，脚本的下载和执行将会按照文档的先后顺序同步进行。当脚本下载和执行的时候，文档解析就会被阻塞，在脚本下载和
执行完成之后文档才能往下继续进行解析,下面是async和defer两者区别：</p> <ul><li><p>当script中有defer属性时，脚本的加载过程和文档加载是异步发生的，等到文档解析完(DOMContentLoaded事件发生)脚本才开始执行。</p></li> <li><p>当script有async属性时，脚本的加载过程和文档加载也是异步发生的。但脚本下载完成后会停止HTML解析，执行脚本，脚本解析完继续HTML解析。</p></li> <li><p>当script同时有async和defer属性时，执行效果和async一致</p></li></ul> <p>对比加载方式：</p> <ol><li>它相比于 preload 加载的优势在于浏览器兼容性好，从 caniuse 上看基本上所有浏览器都支持，覆盖率达到 93%，</li> <li>不足之处在于：defer 只作用于脚本文件，对于样式、图片等资源就无能为力了，并且 defer 加载的资源是要执行的，而 preload 只下载资源并不执行，待真正使用到才会执行文件。</li> <li>对于页面上主/首屏脚本，可以直接使用 defer 加载，而对于非首屏脚本/其它资源，可以采用 preload/prefeth 来进行加载</li></ol> <h3 id="js阻塞原理"><a href="#js阻塞原理" class="header-anchor">#</a> js阻塞原理</h3> <p>浏览器内核可以分成两部分：渲染引擎（Layout Engine 或者 Rendering Engine）和 JS 引擎。早期渲染引擎和 JS 引擎并没有
十分明确的区分，但随着 JS 引擎越来越独立，内核也成了渲染引擎的代称（下文我们将沿用这种叫法）。渲染引擎又包括了 HTML 解释
器、CSS 解释器、布局、网络、存储、图形、音视频、图片解码器等等零部件。</p> <p>JS 引擎是独立于渲染引擎存在的。我们的 JS 代码在文档的何处插入，就在何处执行。当 HTML 解析器遇到一个 script 标签时，它
会暂停渲染过程，将控制权交给 JS 引擎。JS 引擎对内联的 JS 代码会直接执行，对外部 JS 文件还要先获取到脚本、再进行执行。
等 JS 引擎运行完毕，浏览器又会把控制权还给渲染引擎，继续 CSSOM 和 DOM 的构建。 因此与其说是 JS 把 CSS 和 HTML 阻
塞了，不如说是 JS 引擎抢走了渲染引擎的控制权。</p> <p>当CSS后面跟着嵌入的JS的时候，该CSS就会出现阻塞后面资源下载的情况。而当把嵌入JS放到CSS前面，就不会出现css阻塞图片等
的情况了。 根本原因：因为浏览器会维持html中css和js的顺序，即在JS前面出现的CSS文件需要加载、解析完后才会执行后面的
内嵌JS，而内嵌JS又会阻塞后面的内容</p> <p>外部样式会阻塞后面内联脚本的执行；外部样式不会阻塞外部脚本的加载，但会阻塞外部脚本的执行；对于具有async属性的脚本，外部css不会阻塞</p> <h2 id="es6-module循环引入"><a href="#es6-module循环引入" class="header-anchor">#</a> es6 module循环引入</h2> <p>ES module会根据import关系构建一棵依赖树，遍历到树的叶子模块后，然后根据依赖关系，反向找到父模块，将export/import指向同一地址</p> <p>ES module导出的是一个索引——内存地址，它依赖的是“模块地图”和“模块记录”，模块地图在下面会解释，而模块记录是好比每
个模块的“身份证”，记录着一些关键信息——这个模块导出值的的内存地址，加载状态，在其他模块导入时，会做一个“连接”——根据模块记录，把导
入的变量指向同一块内存，这样就是实现了动态绑定</p> <p>来看下面这个例子，和之前的demo逻辑一样：入口模块引用a模块，a模块引用b模块，b模块又引用a模块，这种ab模块相互引用就形成了循环</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.mjs</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> a <span class="token keyword">from</span> <span class="token string">'./a.mjs'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'入口模块引用a模块：'</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>

<span class="token comment">// a.mjs</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">&quot;原始值-a模块内变量&quot;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> b <span class="token keyword">from</span> <span class="token string">&quot;./b.mjs&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;a模块引用b模块：&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token string">&quot;修改值-a模块内变量&quot;</span>

<span class="token comment">// b.mjs</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token string">&quot;原始值-b模块内变量&quot;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> b <span class="token punctuation">}</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> a <span class="token keyword">from</span> <span class="token string">&quot;./a.mjs&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;b模块引用a模块：&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
b <span class="token operator">=</span> <span class="token string">&quot;修改值-b模块内变量&quot;</span>
</code></pre></div><p><img src="/webLearningRecord/assets/img/2.51af7e4c.png" alt="An image">
值得一提的是，import语句有提升的效果，实际执行可以看作这样：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.mjs</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> a <span class="token keyword">from</span> <span class="token string">'./a.mjs'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'入口模块引用a模块：'</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>

<span class="token comment">// a.mjs</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> b <span class="token keyword">from</span> <span class="token string">&quot;./b.mjs&quot;</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">&quot;原始值-a模块内变量&quot;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;a模块引用b模块：&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token string">&quot;修改值-a模块内变量&quot;</span>

<span class="token comment">// b.mjs</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> a <span class="token keyword">from</span> <span class="token string">&quot;./a.mjs&quot;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token string">&quot;原始值-b模块内变量&quot;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> b <span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;b模块引用a模块：&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
b <span class="token operator">=</span> <span class="token string">&quot;修改值-b模块内变量&quot;</span>
</code></pre></div><p>总结一下：和上面一样，循环引用要解决的无非是两个问题，保证不进入死循环以及输出什么值。ES Module来处理循环使用一张模块间的依赖地图
来解决死循环问题，标记进入过的模块为“获取中”，所以循环引用时不会再次进入；使用模块记录，标注要去哪块内存中取值，将导入导出做连接，解
决了要输出什么值</p> <h2 id="杂物"><a href="#杂物" class="header-anchor">#</a> 杂物</h2> <p>undefined 在 ES5 中已经是全局对象的一个只读（read - only）属性了，它不能被重写。但是在局部作用域中，还是可以被重写的；
void 运算符能对给定的表达式进行求值，然后返回 undefined。也就是说，void 后面你随便跟上一个表达式，返回的都是 undefined，
如 void (2), void (‘hello’) 。并且void是不能被重写的。但为什么是void 0 呢，void 0 是表达式中最短的。用 void 0 代
替 undefined 能节省字节。不少 JavaScript压缩工具在压缩过程中，正是将 undefined 用 void 0 代替掉了</p> <ol><li><a href="https://docschina.org/" target="_blank" rel="noopener noreferrer">各种框架中文文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://tool.lu/" target="_blank" rel="noopener noreferrer">众多工具集合，包括时间戳转换，进制转换等<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.cn/post/7169557366587785229" target="_blank" rel="noopener noreferrer">实现一个基于WebRTC的音视频通信系统<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/webLearningRecord/react/two.html" class="prev">
        react架构实现
      </a></span> <span class="next"><a href="/webLearningRecord/forget/two.html">
        TypeScript
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/webLearningRecord/assets/js/app.bdc4d5ac.js" defer></script><script src="/webLearningRecord/assets/js/2.1a231426.js" defer></script><script src="/webLearningRecord/assets/js/19.ec38cef5.js" defer></script>
  </body>
</html>
